<!DOCTYPE html>
<html lang="en">


<!-- molla/index-4.html  22 Nov 2019 09:53:08 GMT -->

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Molla - Bootstrap eCommerce Template</title>
    <meta name="keywords" content="HTML5 Template">
    <meta name="description" content="Molla - Bootstrap eCommerce Template">
    <meta name="author" content="p-themes">
    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="assets/images/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/images/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/images/icons/favicon-16x16.png">
    <link rel="manifest" href="assets/images/icons/site.html">
    <link rel="mask-icon" href="assets/images/icons/safari-pinned-tab.svg" color="#666666">
    <link rel="shortcut icon" href="assets/images/icons/favicon.ico">
    <meta name="apple-mobile-web-app-title" content="Molla">
    <meta name="application-name" content="Molla">
    <meta name="msapplication-TileColor" content="#cc9966">
    <meta name="msapplication-config" content="assets/images/icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <link rel="stylesheet" href="assets/vendor/line-awesome/line-awesome/line-awesome/css/line-awesome.min.css">
    <!-- Plugins CSS File -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/plugins/owl-carousel/owl.carousel.css">
    <link rel="stylesheet" href="assets/css/plugins/magnific-popup/magnific-popup.css">
    <link rel="stylesheet" href="assets/css/plugins/jquery.countdown.css">
    <!-- Main CSS File -->
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/skins/skin-demo-4.css">
    <link rel="stylesheet" href="assets/css/demos/demo-4.css">
</head>

<body>
    <div class="page-wrapper">


        <main class="main">
            <div class="intro-slider-container mb-5">
                <div class="intro-slider owl-carousel owl-theme owl-nav-inside owl-light" data-toggle="owl"
                    data-owl-options='{
                        "dots": true,
                        "nav": false, 
                        "responsive": {
                            "1200": {
                                "nav": true,
                                "dots": false
                            }
                        }
                    }'>
                    <div class="intro-slide"
                        style="background-image: url(product-image/slide1.jpg);">
                        <div class="container intro-content">
                            <div class="row justify-content-end">
                                <div class="col-auto col-sm-7 col-md-6 col-lg-5">
                                    <h3 class="intro-subtitle text-third">Deals and Promotions</h3>
                                    <!-- End .h3 intro-subtitle -->
                                    <h1 class="intro-title"></h1>
                                    <h1 class="">Create Happiness With Toys </h1><!-- End .intro-title -->

                                    <div class="intro-price">
                                        <h3>Price Starting From</h3>
                                        <sup class="intro-old-price">Rs349</sup>
                                        <span class="text-third">
                                            Rs279<sup>.99</sup>
                                        </span>
                                    </div><!-- End .intro-price -->

                                    <a href="/products" class="btn btn-primary btn-round">
                                        <span>Shop More</span>
                                        <i class="icon-long-arrow-right"></i>
                                    </a>
                                </div><!-- End .col-lg-11 offset-lg-1 -->
                            </div><!-- End .row -->
                        </div><!-- End .intro-content -->
                    </div><!-- End .intro-slide -->

                    <div class="intro-slide"
                        style="background-image: url(product-image/slide2.jpg);">
                        <div class="container intro-content">
                            <div class="row justify-content-end">
                                <div class="col-auto col-sm-7 col-md-6 col-lg-5">
                                    <h3 class="intro-subtitle text-primary">New Arrivals</h3>
                                    <!-- End .h3 intro-subtitle -->
                                    <h1 class="intro-title">Pick the best toy for your children  </h1>
                                    <!-- End .intro-title -->

                                    <div class="intro-price">
                                        <sup>Today's Offer:</sup>
                                        <span class="text-primary">
                                            10-50%<sup>Off</sup>
                                        </span>
                                    </div><!-- End .intro-price -->

                                    <a href="category.html" class="btn btn-primary btn-round">
                                        <span>Shop More</span>
                                        <i class="icon-long-arrow-right"></i>
                                    </a>
                                </div><!-- End .col-md-6 offset-md-6 -->
                            </div><!-- End .row -->
                        </div><!-- End .intro-content -->
                    </div><!-- End .intro-slide -->
                </div><!-- End .intro-slider owl-carousel owl-simple -->

                <span class="slider-loader"></span><!-- End .slider-loader -->
            </div><!-- End .intro-slider-container -->





            <div class="container">
                <h2 class="title text-center mb-4">Explore Popular Brands</h2><!-- End .title text-center -->
              
                <div class="cat-blocks-container">
                    <div class="row">
                        {{#each brands}}
                    
                        <div class="col-6 col-sm-4 col-lg-2">
                            <a href="/products?brand={{this.name}}" class="cat-block">
                                <figure>
                                    <span>
                                        <img src="/{{this.image}}" style="width:150px ;"
                                            alt="Category image">
                                    </span>
                                </figure>

                                <h3 class="cat-block-title">{{this.brand}}</h3><!-- End .cat-block-title -->
                            </a>
                        </div><!-- End .col-sm-4 col-lg-2 -->

                        {{/each}}
                    </div><!-- End .row -->
                </div><!-- End .cat-blocks-container -->
            </div><!-- End .container -->




            <div class=" pt-5 pb-10 mb-3 mt-2">
                <div class="container">
                    <div class="heading heading-center mb-3">
                        <h2 class="title-lg">New Arrivals</h2><!-- End .title -->
                    </div><!-- End .heading -->

                    <div class="tab-content tab-content-carousel">
                        <div class="tab-pane tab-pane-shadow p-0 fade show active" id="new-all-tab" role="tabpanel"
                            aria-labelledby="new-all-link">
                            <div class="owl-carousel owl-simple carousel-equal-height" data-toggle="owl"
                                data-owl-options='{
                                    "nav": false, 
                                    "dots": true,
                                    "margin": 0,
                                    "loop": false,
                                    "responsive": {
                                        "0": {
                                            "items":2
                                        },
                                        "480": {
                                            "items":2
                                        },
                                        "768": {
                                            "items":3
                                        },
                                        "992": {
                                            "items":4
                                        },
                                        "1200": {
                                            "items":4,
                                            "nav": true
                                        }
                                    }
                                }'>

                                {{#each products}}
                                <div class="product product-3 text-center ml-5">
                                    <figure class="product-media">

                                        <a href="/product-details/{{this._id}}">
                                            <img src="/{{this.images.[0]}}" alt="Product image"
                                                class="product-image">
                                            {{!-- <img src="/images/product/{{this.image}}" alt="Product image"
                                                class="product-image-hover"> --}}
                                        </a>

                                        <div class="product-action-vertical">
                                            <a href="/homewishlist/{{this._id}}" class="btn-product-icon btn-wishlist btn-expandable"><span>add
                                                    to wishlist</span></a>
                                        </div><!-- End .product-action-vertical -->
                                    </figure><!-- End .product-media -->

                                    <div class="product-body">
                                        <div class="product-cat">
                                            <a href="#">{{this.brand.name}}</a>
                                        </div><!-- End .product-cat -->
                                        <h3 class="product-title"><a href="product.html">{{this.name}}</a></h3>
                                        <!-- End .product-title -->
                                        <div class="product-price text-dark">
                                            {{!-- Rs&nbsp;:&nbsp;{{this.price}} --}}
                                            {{#if this.discount}}
                                            <span style="font-weight: bolder;" class="product-discounted-price mr-2">
                                     ₹ {{calcDiscountedPrice this.price this.discount}}
                                </span>
                                            <div>
                                                  <span style="color: red;" class="product-original-price">
                                    <del> ₹ {{this.price}}</del>
                                </span>
                                                <span
                                                    class="text-success ml-3"> {{ this.discount}}%Off</span>
                                            </div>
                                            {{/if}}
                                        </div><!-- End .product-price -->
                                    </div><!-- End .product-body -->
                                    <div class="product-footer">
                                        {{#if this.stock}}
                                        {{#if this.cartPresent}}
                                        <div class="product-action">
                                           <a href="/cart/{{this._id}}" type="button" class="btn btn-secondary btn-lg btn-block"
                                                >Go to cart</a>
                                        </div>
                                        {{else}}
                                        <div>
                                            <button type="button" class="btn btn-secondary btn-lg btn-block"
                                               data-product-id="{{this._id}}" onclick="addToCart(this)">Add to cart</button>
                                        </div><!-- End .product-action -->
                                        {{/if}}
                                        {{else}}
                                        <div>
                                        <button type="button" class="btn btn-danger btn-lg btn-block" disabled
                                                >Out of stock</button>
                                        </div>
                                        {{/if}}
                                    </div><!-- End .product-footer -->
                                </div><!-- End .product -->
                                {{/each}}
                            </div><!-- End .owl-carousel -->
                        </div><!-- .End .tab-pane -->
                    </div><!-- End .tab-content -->
                </div><!-- End .container -->
            </div><!-- End .bg-light -->
        </main><!-- End .main -->
    </div><!-- End .page-wrapper -->
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script>
        async function addToCart(button) {
            const productId = button.getAttribute('data-product-id');

            try {
                const response = await fetch(`/add-to-cart?productId=${productId}`, {
                    method: 'GET'
                });
                const data = await response.json();

                if (data.success) {
                    Swal.fire({
                        text: 'Product successfully added to cart',
                        icon: 'success',
                        showConfirmButton: false,
                        timer: 2000,
                        customClass: {
                            title: 'text-success',
                            popup: 'swal2-popup-custom'
                        }
                    });
                } else if (data.message === 'User not logged in') {
                    Swal.fire({
                        text: 'You must be logged in to add products to the cart',
                        icon: 'warning',
                        confirmButtonText: 'OK'
                    });
                } else {
                    Swal.fire({
                        text: data.message,
                        icon: 'error',
                        confirmButtonText: 'OK'
                    });
                }
            } catch (error) {
                console.error('Error adding to cart:', error);
            }
        }

    </script>
</body>
</html>